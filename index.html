async function loadDocuments() {
    const agenda = document.getElementById('agenda');
    const carousel = document.getElementById('carousel');
    const formIframe = document.getElementById('form-iframe');
    const calendarContainer = document.querySelector('.calendar-container');
    const docsContainer = document.getElementById('docs-container');
    const docsBody = document.getElementById('docs-body');
    const spreadsheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRDrOq9QJjLjm825s9w7E1Kg-tDR5ONxKTsh-WH6FYdo9tPU_sfLAH4JrKFfendkdx3gTUFUP9guaBL/pub?gid=1850767781&single=true&output=csv';

    if (formIframe) formIframe.remove();
    if (calendarContainer) calendarContainer.remove();
    carousel.style.display = 'none';
    docsContainer.classList.add('active');
    document.getElementById('loading-overlay').style.display = 'flex';

    try {
        const response = await fetch(spreadsheetUrl);
        const csvText = await response.text();
        const rows = csvText.split('\n').map(row => row.split(','));
        const dataRows = rows.slice(1); // Pula o cabeçalho

        docsBody.innerHTML = '';

        dataRows.forEach(row => {
            if (row.length >= 10) { // Garante que a linha tem todas as colunas esperadas
                const produto = row[3]; // Coluna D - Produto (índice 3)
                const link = row[9];    // Coluna J - Link do Documento (índice 9)
                const tableRow = document.createElement('tr');
                tableRow.innerHTML = `
                    <td>${produto}</td>
                    <td><a href="${link}" target="_blank">Abrir Documento</a></td>
                `;
                docsBody.appendChild(tableRow);
            }
        });
        hideLoading();
    } catch (error) {
        console.error('Erro ao carregar os dados:', error);
        docsBody.innerHTML = '<tr><td colspan="2">Erro ao carregar os dados.</td></tr>';
        handleIframeError();
    }
}
